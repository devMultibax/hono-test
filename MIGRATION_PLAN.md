# ‡πÅ‡∏ú‡∏ô‡∏Å‡∏≤‡∏£‡∏û‡∏±‡∏í‡∏ô‡∏≤‡∏£‡∏∞‡∏ö‡∏ö Hono ‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö‡∏ñ‡πâ‡∏ß‡∏ô‡∏ï‡∏≤‡∏°‡∏£‡∏∞‡∏ö‡∏ö Express

## ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô

‡∏£‡∏∞‡∏ö‡∏ö Hono ‡πÑ‡∏î‡πâ‡∏û‡∏±‡∏í‡∏ô‡∏≤‡∏ü‡∏µ‡πÄ‡∏à‡∏≠‡∏£‡πå‡∏´‡∏•‡∏±‡∏Å‡πÑ‡∏õ‡πÅ‡∏•‡πâ‡∏ß ‡πÑ‡∏î‡πâ‡πÅ‡∏Å‡πà:
- ‚úÖ Authentication & Authorization (JWT - ‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÄ‡∏õ‡πá‡∏ô Cookie-based)
- ‚úÖ User Management (CRUD)
- ‚úÖ Department Management (CRUD)
- ‚úÖ Section Management (CRUD)
- ‚úÖ Role-based Access Control
- ‚úÖ Zod Validation
- ‚úÖ Prisma ORM Integration
- ‚úÖ Health Check Endpoints

## ‡∏ü‡∏µ‡πÄ‡∏à‡∏≠‡∏£‡πå‡∏ó‡∏µ‡πà‡∏¢‡∏±‡∏á‡∏Ç‡∏≤‡∏î‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö‡πÄ‡∏Å‡πà‡∏≤

### 1. Security Features (‡∏Ñ‡∏ß‡∏≤‡∏°‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢)
- ‚ùå Cookie-based Authentication (‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏à‡∏≤‡∏Å Bearer Token)
- ‚ùå CSRF Protection
- ‚ùå Rate Limiting
- ‚ùå Security Headers
- ‚ùå Input Sanitization & Validation
- ‚ùå Environment Config Validation

### 2. Admin Functions (‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏ú‡∏π‡πâ‡∏î‡∏π‡πÅ‡∏•‡∏£‡∏∞‡∏ö‡∏ö)
- ‚ùå Database Statistics
- ‚ùå Database Analysis
- ‚ùå System Logs Viewing
- ‚ùå Backup Management
- ‚ùå Backup Restoration

### 3. Export & Import Features (‡∏ô‡∏≥‡πÄ‡∏Ç‡πâ‡∏≤-‡∏™‡πà‡∏á‡∏≠‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•)
- ‚ùå Pagination & Filtering (‡∏à‡∏≥‡πÄ‡∏õ‡πá‡∏ô‡∏Å‡πà‡∏≠‡∏ô‡∏ó‡∏≥ Export/Import)
- ‚ùå Excel Export (Users, Departments, Sections)
- ‚ùå PDF Export (Users, Departments, Sections)
- ‚ùå Excel Import (Departments, Sections)
- ‚ùå File Upload Support

### 4. Master Data Endpoints (API ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏´‡∏•‡∏±‡∏Å)
- ‚ùå GET /master-data/departments
- ‚ùå GET /master-data/departments/:id/sections
- ‚ùå POST /master-data/departments/sections/search
- ‚ùå GET /master-data/users
- ‚ùå GET /master-data/users/from-logs

### 5. Enhanced User Management
- ‚ùå Password Verification Endpoint
- ‚ùå Password Reset Endpoint
- ‚ùå Default Password Tracking
- ‚ùå User Profile Update Endpoint (PUT /auth/me)
- ‚ùå User Password Update Endpoint (PUT /auth/me/password)

### 6. Automated Tasks (‡∏á‡∏≤‡∏ô‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥)
- ‚ùå Scheduled Database Backups (Daily at 02:00 AM)
- ‚ùå Log Rotation

### 7. User Activity Logging
- ‚ùå Comprehensive User Action Logging (‡∏Ñ‡∏£‡∏≠‡∏ö‡∏Ñ‡∏•‡∏∏‡∏°‡∏ó‡∏∏‡∏Å action)
- ‚ùå User Log Retrieval API

### 8. API Documentation
- ‚ùå Swagger/OpenAPI Documentation (auto-generate ‡∏à‡∏≤‡∏Å Zod schemas)

---

## ‡πÅ‡∏ú‡∏ô‡∏Å‡∏≤‡∏£‡∏û‡∏±‡∏í‡∏ô‡∏≤ (Implementation Plan)

### Phase 1: Security & Authentication (‡∏™‡∏±‡∏õ‡∏î‡∏≤‡∏´‡πå‡∏ó‡∏µ‡πà 1-2)

#### 1.1 Cookie-based Authentication
**Priority: CRITICAL**
- ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏à‡∏≤‡∏Å Bearer Token ‡πÄ‡∏õ‡πá‡∏ô Cookie-based JWT
- ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ HttpOnly, Secure, SameSite cookies
- Token versioning ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö revocation
- ‡πÄ‡∏û‡∏¥‡πà‡∏° logout endpoint (clear cookie)

**Files to modify:**
- `src/middleware/auth.ts`
- `src/services/auth.service.ts`
- `src/routes/auth.routes.ts`
- `src/config/env.ts`

#### 1.2 Rate Limiting
**Priority: CRITICAL**
- ‡πÄ‡∏û‡∏¥‡πà‡∏° rate limiting middleware ‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô brute force attacks
- ‡∏Å‡∏≥‡∏´‡∏ô‡∏î limits ‡πÅ‡∏¢‡∏Å‡∏ï‡∏≤‡∏° endpoint
- Libraries: `@hono/rate-limiter`

**Files to create/modify:**
- `src/middleware/rate-limit.ts`
- `src/index.ts`

#### 1.3 CSRF Protection
**Priority: HIGH**
- ‡∏™‡∏£‡πâ‡∏≤‡∏á CSRF token generation ‡πÅ‡∏•‡∏∞ validation
- ‡πÄ‡∏û‡∏¥‡πà‡∏° endpoint GET /auth/csrf-token
- Implement CSRF middleware ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö POST/PUT/DELETE requests

**Files to create/modify:**
- `src/middleware/csrf.ts`
- `src/routes/auth.routes.ts`
- `src/lib/csrf-utils.ts`

#### 1.4 Security Headers
**Priority: MEDIUM**
- ‡πÄ‡∏û‡∏¥‡πà‡∏° security headers middleware
- Configure Content Security Policy, X-Frame-Options, etc.

**Files to create/modify:**
- `src/middleware/security-headers.ts`
- `src/index.ts`

#### 1.5 Input Sanitization & Validation
**Priority: CRITICAL**
- XSS protection ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö user input
- File upload validation (‡∏Ç‡∏ô‡∏≤‡∏î, ‡∏ä‡∏ô‡∏¥‡∏î‡πÑ‡∏ü‡∏•‡πå, MIME type)
- SQL Injection prevention (Prisma ‡∏ä‡πà‡∏ß‡∏¢‡∏≠‡∏¢‡∏π‡πà‡πÅ‡∏•‡πâ‡∏ß)

**Files to create:**
- `src/utils/sanitize.utils.ts`
- `src/utils/file-validator.utils.ts`

#### 1.6 Environment Config Validation
**Priority: CRITICAL**
- ‡πÉ‡∏ä‡πâ Zod validate environment variables
- ‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô runtime errors ‡∏à‡∏≤‡∏Å config ‡∏ú‡∏¥‡∏î

**Files to modify:**
- `src/config/env.ts`

#### 1.7 API Documentation (Swagger)
**Priority: CRITICAL**
- Auto-generate Swagger docs ‡∏à‡∏≤‡∏Å Zod schemas
- Interactive API documentation
- Libraries: `@hono/zod-openapi`

**Files to create/modify:**
- `src/index.ts` (setup OpenAPI)
- `src/routes/*.routes.ts` (add OpenAPI metadata)

---

### Phase 2: Data Management & Export Features (‡∏™‡∏±‡∏õ‡∏î‡∏≤‡∏´‡πå‡∏ó‡∏µ‡πà 3-4)

#### 2.0 Pagination & Filtering
**Priority: HIGH**
- ‡πÄ‡∏û‡∏¥‡πà‡∏° **offset-based pagination** (page, limit) ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ó‡∏∏‡∏Å list endpoints
- ‡πÄ‡∏û‡∏¥‡πà‡∏° **database indexes** (username, email, departmentId, sectionId, createdAt, status)
- ‡∏™‡∏£‡πâ‡∏≤‡∏á **pagination utility** ‡∏ó‡∏µ‡πà‡∏¢‡∏∑‡∏î‡∏´‡∏¢‡∏∏‡πà‡∏ô (centralized logic)
- Query params: page, limit, sort, search
- Filter by department, section, role, status
- Response format: { data, pagination: { total, page, limit, totalPages } }

**‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏≠‡∏ô‡∏≤‡∏Ñ‡∏ï:**
- ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÄ‡∏û‡∏¥‡πà‡∏° module ‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• > 10k rows ‚Üí ‡∏û‡∏¥‡∏à‡∏≤‡∏£‡∏ì‡∏≤‡πÄ‡∏û‡∏¥‡πà‡∏° cursor-based pagination
- Pagination utility ‡∏≠‡∏≠‡∏Å‡πÅ‡∏ö‡∏ö‡πÉ‡∏´‡πâ‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö‡∏ó‡∏±‡πâ‡∏á offset ‡πÅ‡∏•‡∏∞ cursor (flexible)

**Files to create:**
- `src/utils/pagination.utils.ts` (abstraction layer)

**Files to modify:**
- `prisma/schema.prisma` (‡πÄ‡∏û‡∏¥‡πà‡∏° @@index ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö performance)
- `src/routes/users.routes.ts`
- `src/routes/department.routes.ts`
- `src/routes/section.routes.ts`
- `src/services/*.service.ts`
- `src/schemas/*.schema.ts` (add pagination schemas)

#### 2.1 Excel Export
**Priority: HIGH**
- User list export to Excel
- Department list export to Excel
- Section list export to Excel
- **Export strategy ‡πÅ‡∏¢‡∏Å‡∏ï‡∏≤‡∏°‡∏Ç‡∏ô‡∏≤‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•:**
  - < 10k rows: Normal export (fast, simple)
  - 10k-50k rows: **Streaming export** (memory efficient)
  - \> 50k rows: Error + suggest filters
- Libraries: `exceljs` (‡∏°‡∏µ streaming API)

**Files to create:**
- `src/services/export.service.ts` (‡∏°‡∏µ logic ‡πÅ‡∏¢‡∏Å strategy ‡∏ï‡∏≤‡∏°‡∏Ç‡∏ô‡∏≤‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•)
- `src/routes/users.routes.ts` (add GET /export/excel)
- `src/routes/department.routes.ts` (add GET /export/excel)
- `src/routes/section.routes.ts` (add GET /export/excel)

#### 2.2 PDF Export
**Priority: HIGH**
- User list export to PDF with custom formatting
- Department/Section export to PDF
- Thai font support
- **Export strategy ‡πÅ‡∏¢‡∏Å‡∏ï‡∏≤‡∏°‡∏Ç‡∏ô‡∏≤‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•:** (‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô Excel Export)
  - < 10k rows: Normal export
  - 10k-50k rows: **Streaming export**
  - \> 50k rows: Error + suggest filters
- Libraries: `pdfkit`, `@pdf-lib/fontkit`

**Files to create:**
- `src/services/pdf-export.service.ts` (‡∏°‡∏µ streaming support)
- `src/routes/users.routes.ts` (add GET /export/pdf)
- `src/routes/department.routes.ts` (add GET /export/pdf)
- `src/routes/section.routes.ts` (add GET /export/pdf)
- `assets/fonts/` (Thai fonts)

#### 2.3 Excel Import
**Priority: HIGH**
- Department import from Excel
- Section import from Excel
- File upload handling
- Libraries: `@hono/node-server` with multipart, `xlsx`

**Files to create:**
- `src/services/import.service.ts`
- `src/middleware/upload.ts`
- `src/routes/department.routes.ts` (add POST /import)
- `src/routes/section.routes.ts` (add POST /import)
- `src/schemas/import.schema.ts`
- `storage/uploads/` (upload directory)

---

### Phase 3: Master Data Endpoints (‡∏™‡∏±‡∏õ‡∏î‡∏≤‡∏´‡πå‡∏ó‡∏µ‡πà 5)

#### 3.1 Master Data Routes
**Priority: MEDIUM**
- GET /master-data/departments - ‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• departments ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î (simplified)
- GET /master-data/departments/:id/sections - ‡∏î‡∏∂‡∏á sections ‡∏Ç‡∏≠‡∏á department
- POST /master-data/departments/sections/search - ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤ sections ‡∏ï‡∏≤‡∏°‡∏ä‡∏∑‡πà‡∏≠
- GET /master-data/users - ‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• users ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
- GET /master-data/users/from-logs - ‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• users ‡∏à‡∏≤‡∏Å logs

**Files to create:**
- `src/routes/master-data.routes.ts`
- `src/services/master-data.service.ts`
- `src/schemas/master-data.schema.ts`

---

### Phase 4: Enhanced User Management (‡∏™‡∏±‡∏õ‡∏î‡∏≤‡∏´‡πå‡∏ó‡∏µ‡πà 6)

#### 4.1 Password Management
**Priority: HIGH**
- POST /users/password/verify - ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô
- PATCH /users/:id/password/reset - ‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô
- PUT /auth/me/password - ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡∏ï‡∏±‡∏ß‡πÄ‡∏≠‡∏á
- ‡πÄ‡∏û‡∏¥‡πà‡∏° tracking `isDefaultPassword` ‡πÉ‡∏ô User model

**Files to modify:**
- `prisma/schema.prisma` (add isDefaultPassword, tokenVersion fields)
- `src/routes/users.routes.ts`
- `src/routes/auth.routes.ts`
- `src/services/user.service.ts`
- `src/services/auth.service.ts`
- `src/schemas/user.schema.ts`

#### 4.2 User Profile Management
**Priority: MEDIUM**
- GET /auth/me - ‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• current user
- PUT /auth/me - ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ï‡∏±‡∏ß‡πÄ‡∏≠‡∏á

**Files to modify:**
- `src/routes/auth.routes.ts`
- `src/services/auth.service.ts`
- `src/schemas/auth.schema.ts`

---

### Phase 5: Admin Functions (‡∏™‡∏±‡∏õ‡∏î‡∏≤‡∏´‡πå‡∏ó‡∏µ‡πà 7-8)

#### 5.1 Database Management
**Priority: HIGH**
- GET /api/database/statistics - ‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• (table sizes, row counts)
- POST /api/database/analyze - ‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•

**Files to create:**
- `src/routes/database.routes.ts`
- `src/services/database.service.ts`
- `src/middleware/permission.ts` (ensure admin only)

#### 5.2 System Logs
**Priority: MEDIUM**
- GET /api/admin/logs - ‡∏î‡∏π‡∏£‡∏∞‡∏ö‡∏ö‡∏•‡πá‡∏≠‡∏Å
- Enhanced logging with Pino (‡πÄ‡∏£‡πá‡∏ß‡∏Å‡∏ß‡πà‡∏≤ Winston, ‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏Å‡∏±‡∏ö Hono)
- Daily log rotation
- Libraries: `pino`, `pino-http`

**Files to create:**
- `src/routes/admin.routes.ts`
- `src/services/system-log.service.ts`
- `src/lib/logger.ts` (replace console logs with Pino)
- `storage/logs/` (log directory)

#### 5.3 Backup Management
**Priority: HIGH**
- GET /api/admin/backup - ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£ backups
- POST /api/admin/backup - ‡∏™‡∏£‡πâ‡∏≤‡∏á backup
- GET /api/admin/backup/:fileName - ‡∏î‡∏π‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• backup
- POST /api/admin/backup/:fileName/restore - restore ‡∏à‡∏≤‡∏Å backup
- Libraries: `pg_dump` wrapper, `child_process`

**Files to create:**
- `src/routes/backup.routes.ts`
- `src/services/backup.service.ts`
- `src/utils/pgpass.utils.ts`
- `src/utils/file.utils.ts`
- `storage/backups/` (backup directory)

---

### Phase 6: Automated Tasks (‡∏™‡∏±‡∏õ‡∏î‡∏≤‡∏´‡πå‡∏ó‡∏µ‡πà 9)

#### 6.1 Scheduled Backups
**Priority: MEDIUM**
- Daily database backup at 02:00 AM
- Backup retention policy (e.g., keep last 30 days)
- Libraries: `node-cron`

**Files to create:**
- `src/services/scheduled-backup.service.ts`
- `src/index.ts` (start cron job)

#### 6.2 Log Rotation
**Priority: LOW**
- Automatic log rotation and cleanup
- Pino automatic rotation

**Files to modify:**
- `src/lib/logger.ts`

---

### Phase 7: Enhanced User Activity Logging (‡∏™‡∏±‡∏õ‡∏î‡∏≤‡∏´‡πå‡∏ó‡∏µ‡πà 10)

#### 7.1 Comprehensive Logging
**Priority: MEDIUM**
- Log all user actions: CREATE, UPDATE, DELETE, LOGIN, LOGOUT
- Extend UserLog model if needed
- Ensure all service methods call logging

**Files to modify:**
- `prisma/schema.prisma` (verify UserLog model)
- `src/services/auth.service.ts`
- `src/services/user.service.ts`
- `src/services/department.service.ts`
- `src/services/section.service.ts`

#### 7.2 User Log Retrieval
**Priority: LOW**
- API endpoint to retrieve user activity logs
- Filtering by date, user, action type

**Files to create:**
- `src/routes/user-logs.routes.ts`
- `src/services/user-log.service.ts`

---

### Phase 8: Testing & Quality Assurance (‡∏™‡∏±‡∏õ‡∏î‡∏≤‡∏´‡πå‡∏ó‡∏µ‡πà 11-12)

#### 8.1 Testing
**Priority: HIGH**
- Unit tests for services
- Integration tests for routes
- E2E tests
- Libraries: `vitest`, `supertest`

**Files to create:**
- `tests/unit/`
- `tests/integration/`
- `tests/e2e/`
- `vitest.config.ts`

---

## ‡∏•‡∏≥‡∏î‡∏±‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç (Priority Summary)

### Critical (‡∏ï‡πâ‡∏≠‡∏á‡∏ó‡∏≥‡∏Å‡πà‡∏≠‡∏ô‡∏´‡∏°‡∏î - Phase 1)
1. **Cookie-based Authentication** (‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏à‡∏≤‡∏Å Bearer Token)
2. **Rate Limiting & CSRF Protection**
3. **API Documentation** (Swagger/OpenAPI)
4. **Input Sanitization & Validation**
5. **Environment Config Validation**

### High Priority (‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç‡∏°‡∏≤‡∏Å - Phase 2-4)
6. **Pagination & Filtering**
7. **Excel/PDF Export** (Users, Departments, Sections)
8. **Excel Import** (Departments, Sections)
9. **Password Management** (Reset, Verify)
10. **Database Backup & Restore**
11. **Testing Implementation**

### Medium Priority (‡∏õ‡∏≤‡∏ô‡∏Å‡∏•‡∏≤‡∏á - Phase 5-7)
12. Database Statistics & Analysis
13. System Logs Viewing (Pino)
14. Master Data Endpoints
15. User Profile Management
16. Scheduled Backups
17. Comprehensive User Logging

### Low Priority (‡∏ó‡∏≥‡∏ó‡∏µ‡∏´‡∏•‡∏±‡∏á)
18. Security Headers
19. Log Rotation
20. User Log Retrieval API

---

## ‡∏Ç‡πâ‡∏≠‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£

### ‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏ó‡∏µ‡πà 1: ‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á Dependencies
```bash
# Phase 1: Security & Authentication
npm install @hono/rate-limiter @hono/zod-openapi

# Phase 2: Export & Import
npm install exceljs xlsx pdfkit @pdf-lib/fontkit
npm install --save-dev @types/pdfkit

# Phase 5: Logging
npm install pino pino-http

# Phase 6: Scheduled Tasks
npm install node-cron
npm install --save-dev @types/node-cron
```

### ‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏ó‡∏µ‡πà 2: ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï Prisma Schema
‡πÄ‡∏û‡∏¥‡πà‡∏° fields ‡∏ó‡∏µ‡πà‡∏Ç‡∏≤‡∏î:
- `User.isDefaultPassword` (Boolean)
- `User.tokenVersion` (Int)

‡∏£‡∏±‡∏ô migration:
```bash
npx prisma migrate dev --name add_missing_user_fields
```

### ‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏ó‡∏µ‡πà 3: ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÑ‡∏î‡πÄ‡∏£‡∏Å‡∏ó‡∏≠‡∏£‡∏µ
```bash
mkdir -p storage/backups storage/logs storage/uploads assets/fonts
```

### ‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏ó‡∏µ‡πà 4: ‡∏û‡∏±‡∏í‡∏ô‡∏≤‡∏ï‡∏≤‡∏° Phase
‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏à‡∏≤‡∏Å Phase 1 (Security) ‡πÅ‡∏•‡∏∞‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£‡∏ï‡∏≤‡∏°‡∏•‡∏≥‡∏î‡∏±‡∏ö

### ‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏ó‡∏µ‡πà 5: Testing
‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô tests ‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏π‡πà‡∏Å‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏û‡∏±‡∏í‡∏ô‡∏≤‡πÅ‡∏ï‡πà‡∏•‡∏∞ feature

---

## ‡∏™‡∏£‡∏∏‡∏õ‡∏Ñ‡∏ß‡∏≤‡∏°‡πÅ‡∏ï‡∏Å‡∏ï‡πà‡∏≤‡∏á‡∏´‡∏•‡∏±‡∏Å

| ‡∏ü‡∏µ‡πÄ‡∏à‡∏≠‡∏£‡πå | Express (‡πÄ‡∏Å‡πà‡∏≤) | Hono (‡πÉ‡∏´‡∏°‡πà) | ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ |
|---------|---------------|------------|-------|
| Authentication | JWT Cookies | Bearer Token | ‚ö†Ô∏è ‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÄ‡∏õ‡πá‡∏ô Cookie |
| CRUD Operations | ‚úÖ | ‚úÖ | ‚úÖ ‡πÄ‡∏™‡∏£‡πá‡∏à‡∏™‡∏°‡∏ö‡∏π‡∏£‡∏ì‡πå |
| API Documentation | ‚ùå | ‚ùå | ‚ùå ‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏û‡∏¥‡πà‡∏° Swagger |
| Pagination/Filter | ‚úÖ | ‚ùå | ‚ùå ‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏û‡∏¥‡πà‡∏° |
| Export Excel/PDF | ‚úÖ | ‚ùå | ‚ùå ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ |
| Import Excel | ‚úÖ | ‚ùå | ‚ùå ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ |
| CSRF Protection | ‚úÖ | ‚ùå | ‚ùå ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ |
| Rate Limiting | ‚úÖ | ‚ùå | ‚ùå ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ |
| Input Sanitization | ‚úÖ | ‚ùå | ‚ùå ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ |
| Backup System | ‚úÖ | ‚ùå | ‚ùå ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ |
| Database Stats | ‚úÖ | ‚ùå | ‚ùå ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ |
| System Logs | Winston | Console | ‚ö†Ô∏è ‡∏ï‡πâ‡∏≠‡∏á‡πÉ‡∏ä‡πâ Pino |
| Master Data API | ‚úÖ | ‚ùå | ‚ùå ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ |
| Password Reset | ‚úÖ | ‚ùå | ‚ùå ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ |
| User Logging | Partial | Partial | ‚ö†Ô∏è ‡∏ï‡πâ‡∏≠‡∏á‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∏‡∏á |

---

## ‡∏£‡∏∞‡∏¢‡∏∞‡πÄ‡∏ß‡∏•‡∏≤‡πÇ‡∏î‡∏¢‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì

- **Phase 1** (Security & Auth): 2 ‡∏™‡∏±‡∏õ‡∏î‡∏≤‡∏´‡πå
- **Phase 2** (Data Management & Export/Import): 2-3 ‡∏™‡∏±‡∏õ‡∏î‡∏≤‡∏´‡πå
- **Phase 3-4** (Master Data + User Management): 2 ‡∏™‡∏±‡∏õ‡∏î‡∏≤‡∏´‡πå
- **Phase 5-6** (Admin Functions + Automation): 2-3 ‡∏™‡∏±‡∏õ‡∏î‡∏≤‡∏´‡πå
- **Phase 7-8** (Logging + Testing): 2-3 ‡∏™‡∏±‡∏õ‡∏î‡∏≤‡∏´‡πå

**‡∏£‡∏ß‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î**: ‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì 10-13 ‡∏™‡∏±‡∏õ‡∏î‡∏≤‡∏´‡πå

---

## ‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏

1. ‡πÅ‡∏ú‡∏ô‡∏ô‡∏µ‡πâ‡∏Ñ‡∏£‡∏≠‡∏ö‡∏Ñ‡∏•‡∏∏‡∏°‡∏Å‡∏≤‡∏£‡∏¢‡πâ‡∏≤‡∏¢‡∏ü‡∏µ‡πÄ‡∏à‡∏≠‡∏£‡πå‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö Express ‡∏°‡∏≤‡∏™‡∏π‡πà Hono
2. **‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏à‡∏≤‡∏Å Bearer Token ‡πÄ‡∏õ‡πá‡∏ô Cookie-based JWT** (‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö‡∏£‡∏∞‡∏ö‡∏ö‡πÄ‡∏Å‡πà‡∏≤)
3. **‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πâ Docker** - deploy ‡∏î‡πâ‡∏ß‡∏¢ PM2 ‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡πÄ‡∏î‡∏¥‡∏°
4. **‡πÉ‡∏ä‡πâ Pino ‡πÅ‡∏ó‡∏ô Winston** - ‡πÄ‡∏£‡πá‡∏ß‡∏Å‡∏ß‡πà‡∏≤‡πÅ‡∏•‡∏∞‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏Å‡∏±‡∏ö Hono
5. ‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏õ‡∏£‡∏±‡∏ö‡∏•‡∏≥‡∏î‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏û‡∏±‡∏í‡∏ô‡∏≤‡∏ï‡∏≤‡∏°‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç‡∏Ç‡∏≠‡∏á‡∏ò‡∏∏‡∏£‡∏Å‡∏¥‡∏à‡πÑ‡∏î‡πâ
6. ‡∏Ñ‡∏ß‡∏£‡∏ó‡∏≥ testing ‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏π‡πà‡πÑ‡∏õ‡∏Å‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏û‡∏±‡∏í‡∏ô‡∏≤
7. Prisma ORM ‡∏ä‡πà‡∏ß‡∏¢‡πÉ‡∏´‡πâ‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏á‡πà‡∏≤‡∏¢‡πÅ‡∏•‡∏∞‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢‡∏Å‡∏ß‡πà‡∏≤ raw SQL
8. Hono ‡∏°‡∏µ performance ‡∏ó‡∏µ‡πà‡∏î‡∏µ‡∏Å‡∏ß‡πà‡∏≤ Express ‡πÇ‡∏î‡∏¢‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡πÉ‡∏ô edge runtime

## ‡∏Å‡∏≤‡∏£‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÅ‡∏õ‡∏•‡∏á‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç‡∏à‡∏≤‡∏Å‡πÄ‡∏ß‡∏≠‡∏£‡πå‡∏ä‡∏±‡∏ô‡πÅ‡∏£‡∏Å

### ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÉ‡∏´‡∏°‡πà:
- ‚úÖ Cookie-based Authentication (‡∏¢‡πâ‡∏≤‡∏¢‡∏°‡∏≤ Phase 1 - Critical)
- ‚úÖ API Documentation (Swagger/OpenAPI)
- ‚úÖ Pagination & Filtering
- ‚úÖ Input Sanitization & Validation
- ‚úÖ Environment Config Validation

### ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç:
- üîÑ ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô Winston ‚Üí Pino (‡πÄ‡∏£‡πá‡∏ß‡∏Å‡∏ß‡πà‡∏≤)
- üîÑ Cookie Auth ‡∏à‡∏≤‡∏Å Optional ‚Üí Required
- üîÑ Excel Import ‡∏à‡∏≤‡∏Å Medium ‚Üí High Priority

### ‡∏•‡∏ö‡∏≠‡∏≠‡∏Å:
- ‚ùå Docker Setup (‡πÉ‡∏ä‡πâ PM2 ‡∏≠‡∏¢‡∏π‡πà‡πÅ‡∏•‡πâ‡∏ß)
- ‚ùå Bearer Token support (Web App ‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô)
- ‚ùå Migration System section (Prisma ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡πÅ‡∏•‡πâ‡∏ß)

---

**‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏ô‡∏µ‡πâ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÇ‡∏î‡∏¢**: Claude Code
**‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà**: 2026-01-16
**‡πÄ‡∏ß‡∏≠‡∏£‡πå‡∏ä‡∏±‡∏ô**: 2.0 (‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∏‡∏á)
